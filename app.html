<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta http-equiv="x-ua-compatible" content="ie=9">
<title>DownloaderPRO</title>

<hta:application
  applicationname="DownloaderPRO"
  icon="icone.ico"
  border="thin"
  caption="yes"
  showintaskbar="yes"
  singleinstance="yes"
  sysmenu="yes"
  windowstate="normal"
  scroll="no"
  navigable="no"
/>

<style>
* { box-sizing: border-box; }
body {
  background: #0d1117; color: #e6edf3;
  font-family: 'Segoe UI', Arial, sans-serif;
  margin: 0; padding: 0; overflow: hidden;
}
.box {
  background: #161b22; padding: 35px; border-radius: 12px;
  width: 500px; margin: 30px auto; /* Reduzi a margem superior para caber o novo bot√£o */
  box-shadow: 0 10px 30px rgba(0,0,0,0.5); border: 1px solid #30363d;
}
h1 { text-align: center; margin-bottom: 25px; color: #ffffff; font-size: 28px; }

#painelInstalacao, #painelPrincipal { display: none; }

.btn-setup {
  width: 100%; background: #238636; color: white;
  padding: 20px; border: none; border-radius: 6px;
  font-size: 18px; font-weight: bold; cursor: pointer;
}
.btn-setup:hover { background: #2ea043; }

label { display: block; margin-bottom: 8px; font-size: 12px; color: #8b949e; font-weight: bold; text-transform: uppercase; }
input {
  width: 100%; padding: 12px; border-radius: 6px;
  background: #0d1117; color: white; border: 1px solid #30363d;
  margin-bottom: 15px; font-size: 14px;
}

.btn-row { margin-bottom: 25px; width: 100%; overflow: hidden; }

.btn-secondary {
  background: #21262d; color: #c9d1d9; border: 1px solid #30363d;
  padding: 8px 14px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600;
}
.btn-secondary:hover { background: #30363d; border-color: #8b949e; }

.btn-update {
  background: #1f6feb; 
  color: #ffffff;
  border: 1px solid #388bfd;
}
.btn-update:hover { background: #388bfd; }

.left { float: left; } 
.right { float: right; }

.btn-download {
  width: 100%; padding: 16px; border: none; border-radius: 6px;
  font-size: 16px; font-weight: bold; cursor: pointer; margin-bottom: 12px; color: white; clear: both;
}
.video { background: #238636; }
.video:hover { background: #2ea043; }

.mp3 { background: #1f6feb; }
.mp3:hover { background: #388bfd; }

/* NOVO ESTILO: BOT√ÉO PLAYLIST */
.playlist { background: #8957e5; margin-bottom: 0; }
.playlist:hover { background: #a371f7; }

footer {
  text-align: center; margin-top: 25px; font-size: 12px;
  color: #8b949e; border-top: 1px solid #30363d; padding-top: 15px;
  white-space: nowrap;
}
.piscando { color: #ff7b72 !important; }
</style>

<script>
var shell = new ActiveXObject('WScript.Shell');
var fso = new ActiveXObject("Scripting.FileSystemObject");

function verificarInstalacao() {
    if (fso.FileExists("instalado.txt")) {
        document.getElementById("painelPrincipal").style.display = "block";
        window.resizeTo(580, 750); // Aumentado para 750 para caber o 3¬∫ bot√£o confortavelmente
    } else {
        document.getElementById("painelInstalacao").style.display = "block";
        window.resizeTo(580, 450);
    }
    iniciarPisca();
}

function iniciarPisca() {
    setInterval(function() {
        var el = document.getElementById("aviso");
        if (el) el.className = (el.className === "") ? "piscando" : "";
    }, 600);
}

function instalacaoInicial() {
    shell.Run('instalar.bat', 1, true);
    alert("Instala√ß√£o conclu√≠da!");
    location.reload();
}

function escolherPasta() {
  var folder = new ActiveXObject("Shell.Application").BrowseForFolder(0, "Salvar em:", 0);
  if (folder != null) document.getElementById('folderPath').value = folder.Self.Path;
}

function atualizarYTDLP() { 
    shell.Run('cmd /k winget update yt-dlp', 1, false); 
}

function baixar(tipo) {
  var url = document.getElementById('url').value;
  var pasta = document.getElementById('folderPath').value;
  if (url === '') { alert('Cole o link!'); return; }
  shell.Run('cmd /c baixar.bat ' + tipo + ' "' + url + '" "' + pasta + '"', 1, false);
}

window.onload = verificarInstalacao;
</script>
</head>
<body>
    <div class="box">
      <h1>DownloaderPRO</h1>

      <div id="painelInstalacao">
        <p style="text-align:center; margin-bottom:25px; color:#8b949e; font-size:14px;">
          O sistema precisa ser preparado antes do primeiro uso.
        </p>
        <button class="btn-setup" onclick="instalacaoInicial()" 
                style="background: #238636; border: 2px solid #2ea043; height: 80px; font-size: 20px;">
            üì• INICIAR INSTALA√á√ÉO
        </button>
        <p style="text-align:center; margin-top:20px; color:#58a6ff; font-size:11px;">
          * Este processo √© feito apenas uma vez.
        </p>
      </div>

      <div id="painelPrincipal">
          <label>üîó Link do V√≠deo ou Playlist:</label>
          <input id="url" placeholder="Cole o link aqui...">

          <label>üìÅ Salvar na Pasta:</label>
          <input id="folderPath" readonly value="C:\Users\Usuario\Downloads">
          
          <div class="btn-row">
              <button class="btn-secondary left" onclick="escolherPasta()">üëÜ Alterar Destino...</button>
              <button class="btn-secondary btn-update right" onclick="atualizarYTDLP()">üîÑ Atualizar DownloaderPro</button>
          </div>

          <button class="btn-download video" onclick="baixar('video')">üé¨ Baixar V√≠deo</button>
          <button class="btn-download mp3" onclick="baixar('mp3')">üéµ Baixar √Åudio MP3</button>
          <button class="btn-download playlist" onclick="baixar('playlist')">üìÇ Baixar Playlist Completa</button>

          <footer>
            <span id="aviso">O download abrir√° uma janela preta. N√£o a feche at√© que o processo termine!</span>
          </footer>
      </div>
    </div>
</body>
</html>